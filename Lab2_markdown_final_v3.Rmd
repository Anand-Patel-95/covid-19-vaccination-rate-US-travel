---
title: "The Effect of Vaccinations on Tourism Trips"
author: "Anand Patel, Viswanathan Thiagarajan, Vijay Ranganatha"
date: "7/26/2021"
output:
  html_document:
    toc: yes
    df_print: paged
  bookdown::pdf_document2:
    toc: yes
  df_print: kable
  pdf_document:
    toc: yes
---

<style type="text/css">

h1.title {
  text-align: center;
}
h4.author { 
  text-align: center;
}
h4.date { 
  text-align: center;
}
</style>


\newpage
## 1. Introduction

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(magrittr)
library(ggplot2)
library(patchwork)
library(sandwich)
library(lmtest)
library(stargazer)
library(car)
library(GGally)
# install.packages("inspectdf")
library(inspectdf)
library(kableExtra)
```

```{r message=FALSE, include=FALSE}
#Set the Working Directory-Vijay
#setwd("/home/jovyan/W203/Lab2/V1.2/lab-2-section8-team5-lab2-avv/src/data")
# on anand's computer:
#setwd("/home/rstudio/w203/lab-2-section8-team5-lab2-avv/src/data")
#Set the Working Directory-Vis
setwd("~/R Scripts/W203/Lab 2")

# Loading the dataframe from the output of DataWrangling
trips.vs.vaccine.df <- read.csv('final_data_v1.csv', header = TRUE, stringsAsFactors = FALSE)

trips.vs.vaccine.df$X <- NULL
trips.vs.vaccine.df$isRepublican = as.factor(trips.vs.vaccine.df$isRepublican)

```

```{r function for Robust SE,include=FALSE}
get_robust_se <- function(model) { 
    require(sandwich)
    
    sqrt(diag(sandwich::vcovHC(model)))
  }
```



COVID-19 has had a devastating impact on the lives of many people. There were various policies that the government implemented to control the spread of the virus. Such policies as quarantine measures, lockdowns, and travel bans halted tourism travel. After a year-long struggle with the new norms and lockdowns imposed, there appears to be a change in the perception of Covid-19 as vaccines become available to people living in the United States. With vaccination rates increasing in the United States, mask mandates are lifting, people are venturing out to see friends and family, and advertisements are marketing products and activities as "returning" to the pre-pandemic way of life. We must examine if the data supports this return in the context of tourism travel in the continental west coast states. 

With the summer of 2021 approaching, we would like to examine if increasing vaccination rates is leading people to undertake tourism trips again. This research would benefit the **Tourism Board of Continental West Coast States** by informing this organization if places with high vaccination rates show an increased interest in tourism travel and subsequent demand for travel destinations. If our analysis supports that increasing vaccination rates among the West Coast States lead to more tourism travel, then the Tourism Board of Continental West Coast States could plan to increase staffing, reopening of lodging, and increase advertising for travel destinations across Continental West Coast. If no such increase is observed, then the Tourism Board of Continental West Coast States would be informed to decrease or maintain the current operational procedures. Using this information, the Tourism Board can take cognitive action of either increasing, decreasing, or maintaining the current operational state based on the Covid vaccination rates.  Whereby they will be able to optimize their resources and help planning their budget.

### 1.1 Research Question

We are presenting to the tourism board of Continental West Coast states (California, Oregon, Washington) and showing **if having a greater % of vaccinated people is leading to an increase in tourism as represented by more long-distance trips, 50+ miles from home, undertaken.**

### 1.2 Operationalization 

To perform the analysis, we are examining counties from the Continental West Coast States because residents of these counties are likely to undertake tourism travel to locations within these states, and the vaccine drives here have been substantial. The number of counties in California, Oregon, and Washington total 135. 

#### Cross-section in Time

For each county, we observe the percentage of people vaccinated by 1-May-2021 since this is close to the summer. To account for a possible 2-week vaccination incubation for individuals, who were vaccinated exactly on May 1st, we consider the daily tourism trips averaged across 05/14/2021 to 05/21/2021. For covariates, we will also evaluate if the county population, county resident age, if the county leans towards Republican party, and wealth of residents play an important role in determining the number of trips taken as well.


#### Variables

Our outcome variable should measure the number of tourism trips taken. We operationalize a tourism trip as any trip taken that is far enough from home to signify an occasional trip. We consider tourism to be long-distance travel away from home since a long-distance trip is likely to be a special or unique occasion. To analyze the impact of our treatment and controls on tourism, we will consider any trips greater than 50+ miles from home as tourism trips. The US Department of Transportation provides a [county level dataset on the number of trips taken by distance from home](https://data.bts.gov/Research-and-Statistics/Trips-by-Distance/w96p-f2qv). We sum up the columns for trips taken over 50 miles to get the number of long-distance trips taken by the county residents. 

Our treatment variable is county vaccination rate, measured as the percentage of the county population that is fully vaccinated with two doses or one dose from a single-dose vaccine. This data for county-level vaccination rate is readily available at the Center for Disease Control as a [dataset](https://data.cdc.gov/Vaccinations/COVID-19-Vaccinations-in-the-United-States-County/8xkx-amqh). This dataset, for California, does not report vaccination rates for counties with a population below 20,000. We lose 10 California counties as a result.

The county population would directly impact the number of trips undertaken since more individuals mean more people potentially take tourism trips. County population also increases for urban counties versus rural counties, so this variable could also represent urban vs. rural control in our study and capture the difference in Covid impact on these environments if any. Our control for county population is operationalized by calculating the 2021 county population estimate used in the CDC Vaccine Rate dataset using the columns available.

$$\text{pop_est} = 100*\frac{\text{tot_num_vaccinated}}{\text{vaccination_rate}}$$


County resident age can influence how many trips are undertaken since 65+ individuals might not have a long-distance travel oriented lifestyle and tourism trips would likely be low for counties with a high median age. We operationalize county resident age using the county-level median age [dataset available from 2020 U.S. Census population estimates](https://www.census.gov/programs-surveys/popest/technical-documentation/research/evaluation-estimates/2020-evaluation-estimates/2010s-county-detail.html).


Republican-leaning states, like Florida, have shown resistance towards Covid prevention policies and a belief in science for Covid decision making. Republican-leaning areas have been associated with neglecting Covid safety protocols due to residents' beliefs. Adding a control for indicating if a West Coast county leans Republican would capture if people are taking tourism trips mainly based on their beliefs and their associate attitude towards Covid-19. We might expect Republican-leaning counties to have more tourism trips taken regardless of the vaccination rate. We operationalize if a county is Republican-leaning by determining if the county voted more for a Republican candidate in the 2020 presidential race over the Democratic candidate, computed from the [United States General Election Presidential Results](https://github.com/tonmcg/US_County_Level_Election_Results_08-20/blob/master/2020_US_County_Level_Presidential_Results.csv).


We would expect that counties with more wealthy residents have more access to money and means to travel. We operationalize the wealth of residents using the county-level median household income made available in the [USDA's Economic Research Service dataset](https://data.ers.usda.gov/reports.aspx?ID=17828). This dataset also provides the county-level unemployment percentage and percentage of State Median Household Income, which we evaluate as other potential controls but rule out in our analysis below.


#### Our final dataset

We download, clean, and combine the datasets using the following R Markdown file: `src/Lab2_Data_Wrangling.Rmd`. The final dataset is exported at the end of this `Lab2_Data_Wrangling.Rmd` and used for our analysis here.

Our final dataset includes 125 counties, after dropping counties that are missing trips taken (Alpine County in California) and California counties whose vaccination rate was unreported due to the population being below 20,000 (as outlined in the data collection methodology of the CDC vaccination rate dataset). This may present a small issue since we are under-representing small population West Coast counties in our analysis, but dropping only 10 counties from 135 counties would still leave us with a sizeable dataset of 125, which includes a range of counties and populations.

## 2. Model Building Process
We are interested in understanding if increasing vaccination rates is leading people to undertake tourism trips again. We will be using trip information of 50+ miles from home as long-distance trips to capture our outcome variable. The treatment variable would be the vaccination rate. The other covariate variables which we believe might have a meaningful impact are included in our analysis: County Population, County Resident Age, If the County is Republican party leaning, and County Average Income. 

### 2.1 Variables of Interest

```{r conduct EDA in this chunk, echo=FALSE, message=FALSE, warning=FALSE, fig.cap="**Untransformed Variables**"}
# untransformed Number.of.Long.Trips vs Series_Complete_Pop_Pct
d_scatter_1 <- trips.vs.vaccine.df %>% 
  ggplot() + 
  aes(x = (Series_Complete_Pop_Pct), y= (Number.of.Long.Trips)) + 
  geom_smooth(method='lm', se=FALSE, alpha=0.8) +
  geom_point(alpha = 0.1) +
  labs(
    title    = 'LongTrips vs Vaccination %',
    x        = 'Vaccination %',
    y        = 'Number of Long Trips Taken', 
    fill     = ''
  ) +
  theme_light()

d_hist_1 <- trips.vs.vaccine.df %>% 
  ggplot(aes(x= (Number.of.Long.Trips)) ) + 
  geom_histogram(bins=50) +
  labs(
    title    = 'UnTransformed - LongTrips',
    x        = 'Long Trips',
    y        = 'count', 
    col      = 'orange'
  ) +
  theme_light()

d_hist_1 | d_scatter_1
```

Checking the Long Trips in the histogram shows us that the plot is not normal, and the data is much concentrated on the left, producing a right or positive skew. Also, the scatter plot of Vaccination percentage and Number of Long trips, shows us that the data is very much dispersed for Long Trips. Hence, there appears to be a need to apply a transformation to make them normal.

```{r EDA after transforming, echo=FALSE, message=FALSE, fig.cap="**Transformed Variables**"}
# log transformed on Number.of.Long.Trips.
d_scatter_2 <- trips.vs.vaccine.df %>% 
  ggplot() + 
  aes(x = (Series_Complete_Pop_Pct), y= log10(Number.of.Long.Trips)) + 
  geom_smooth(method='lm', se=FALSE, alpha=0.8) +
  geom_point(alpha = 0.1) +
  labs(
    title    = 'Transformed LongTrips & Vaccination%',
    x        = 'Vaccination %',
    y        = 'Number of Long Trips Taken log(10)', 
    fill     = ''
  ) +
  theme_light()

d_hist_2 <- trips.vs.vaccine.df %>% 
  ggplot(aes(x= log10(Number.of.Long.Trips)) ) + 
  geom_histogram(bins=50) +
  labs(
    title    = 'Transformed Frequency of LongTrips',
    x        = 'Long Trips (log10)',
    y        = 'count', 
    col      = 'orange'
  ) +
  theme_light()

d_hist_2 | d_scatter_2

```

After the log10 transformation of the Dependent Variable (Long Trips), the plot appears to be normal when compared to the previous plot.  The scatter plot of Vaccination percentage and Number of Long Trips, shows that the data could be analyzed better with a log10 transformation.

To understand the correlation between the variables that we are interested in analyzing, we look at each of their correlations with each other. The following plot provides the correlation between the different variables:

```{r correlation plot, echo=FALSE, message=FALSE, warning=FALSE, fig.cap="**Columns Correlation**"}

# Creating a dataframe with only the required columns
data_unlabeled <- trips.vs.vaccine.df %>% 
  select(Number.of.Long.Trips, 
         Series_Complete_Pop_Pct,
         County.POP,
         County_Median_Income,
         Income_CountyMedian_vs_StateMedian,
         isRepublican,
         unemployment_pct_2020,
         MEDIAN_AGE_TOT
  )

inspect_cor(data_unlabeled) %>% show_plot(col_palette = 5)

```

The correlation matrix shows a very high positive correlation between the ratio of County Median Income to State Median Income and the County Median Income. Intuitively this makes sense because having a higher county median income means a county would have a directly higher ratio between its median income and the state's median income. Knowing this, we will only use **county median income** to represent wealth as a control for our analysis. 

The other variables are not highly correlated with each other and hence we proceed to use them as part of the model building process.

#### Potential Covariates

We examine the distributions of our covariates, treatment, and outcome variable for non-normal distributions and heavy skews. These non-normalities may impact our model's integrity, and transformations may be necessary.

```{r Transformation on Covariates, include=FALSE}
# 1) untransformed data
pairs(~Number.of.Long.Trips + Series_Complete_Pop_Pct + County.POP + County_Median_Income + isRepublican + unemployment_pct_2020 + MEDIAN_AGE_TOT, data = trips.vs.vaccine.df, main = "Pair Plot: Untransformed Data")

# 2) log10 transformed `Number.of.Long.Trips`
pairs(~log10(Number.of.Long.Trips) + Series_Complete_Pop_Pct + County.POP + County_Median_Income + isRepublican + unemployment_pct_2020 + MEDIAN_AGE_TOT, data = trips.vs.vaccine.df, main = "Pair Plot: Log Transformed Output")

# 3) log10 transformed all
pairs(~log10(Number.of.Long.Trips) + log10(Series_Complete_Pop_Pct) + log10(County.POP) + log10(County_Median_Income) + isRepublican + log10(unemployment_pct_2020) + log10(MEDIAN_AGE_TOT), data = trips.vs.vaccine.df, main = "Pair Plot: Log Transformed All Variables")
```


```{r Checking few data elements, echo=FALSE, message=FALSE, warning=FALSE, fig.cap="**Untransformed Pairs Plot**"}
df_check <- trips.vs.vaccine.df[, c(2, 5, 7, 8, 11, 12, 16)]
#head(df_check)
colnames(df_check) <- make.names(c('Long Trips Count', 
                  'Complete Vaccination Percentage', 
                  'County Population',
                  'County Median Income',
                  'Inclination for Republican',
                  'County Unemployment Percentage',
                  'County Median Age'))

ggpairs(df_check, 
        columnLabels = gsub('.', ' ', colnames(df_check), fixed = T), 
        labeller = label_wrap_gen(10),
        title = "Untransformed: Plots for Outcome and Features",
        axisLabels="none")

```

The above pair plot is for variables with no transformation applied. Following observations can be made about each variable's density plot (along the diagonal):

* Long Trips Count (Outcome Variable) - The distribution is not normal, heavily right-skewed, and hence transformation needs to be applied.

* Complete Vaccination Percentage (Treatment Variable) - The distribution is not normal and is skewed moderately towards the right.

* County Population (covariate) - The distribution is not normal, heavily right-skewed, and hence transformation needs to be applied

* County Median Income - The distribution is not normal and is skewed moderately towards the right.

* Inclination for Republican (covariate) - This is a binary variable and hence bar plot is provided. We can notice that there are more counties inclining more towards the Republican party than the Democrat party, but not by a large number.

* County Unemployment Percentage (covariate) - The distribution is not normal and is skewed moderately towards the right.

* County Median Age (covariate) - The distribution is not normal, skewed slightly towards the right, and transformation may be beneficial. 

For right-skewed distributions, we can transform our variables down the Box-Cox Ladder of Powers. We try transforming all our right-skewed variables using a log base 10 transform, and plotting the GGPairs again to see if we have more normally distributed variables now.

#### Transformations

We will now transform the variables which did not have a normal distribution from the previous observation.
We use a GGPairs plot to look at the correlation between variables, the distributions of the variables on the plot diagonal, and scatterplots of each variable pair.

```{r Transformed ggpairs plot, echo=FALSE, message=FALSE, warning=FALSE, fig.cap="**Transformed Pairs Plot**"}

# create df for just the outcome variable and predictors.
d <- trips.vs.vaccine.df[, c(2, 5, 7, 8, 11, 12, 16)]

# create transformed dataframe
d_tf <- d

# log10
d_tf$Number.of.Long.Trips = log10(d_tf$Number.of.Long.Trips)

# log10
d_tf$Series_Complete_Pop_Pct = log10(d_tf$Series_Complete_Pop_Pct)

# log10
d_tf$County.POP = log10(d_tf$County.POP)

# log10
d_tf$County_Median_Income = log10(d_tf$County_Median_Income)

# log10
d_tf$unemployment_pct_2020 = log10(d_tf$unemployment_pct_2020)

# log10
d_tf$MEDIAN_AGE_TOT = log10(d_tf$MEDIAN_AGE_TOT)

d_tf_1 <- d_tf

colnames(d_tf) <- make.names(c('Long Trips Count', 
                  'Complete Vaccination Percentage', 
                  'County Population',
                  'County Median Income',
                  'Inclination for Republican',
                  'County Unemployment Percentage',
                  'County Median Age'))

pm_1 <- ggpairs(d_tf, 
        columnLabels = gsub('.', ' ', colnames(d_tf), fixed = T), 
        labeller = label_wrap_gen(10),
        title = "Log10 Transformed: Plots for Outcome and Features",
        axisLabels="none")

#levels(pm_1$data$Inclination.for.Republican)[levels(pm_1$data$Inclination.for.Republican) == 0] = "Dem"
#levels(pm_1$data$Inclination.for.Republican)[levels(pm_1$data$Inclination.for.Republican) == 1] = "Rep"

pm_1
```



After the transformation, we notice that all of the distribution of the variables look much more normal now. The `County Median Income` still looks a bit right-skewed. We could go one step further down on the box-cox ladder of powers to transform this feature using a reciprocal root, but that comes at the cost of difficulty in interpreting the coefficient for `County Median Income`. We will choose to log base 10 transform the variables.

From the bar chart for `isRepublican` we can see we have slightly more Republican counties in the dataset than Democratic counties, but the number of counties is almost equal. The Republican counties do have a lower number of long trips taken, lower vaccination rate, lower county population, lower median income, lower unemployment percentage, but higher median age.

```{r echo=FALSE}

# Code plot for making our final df.

d_log10 = d_tf_1

d_log10 = rename(d_log10, Number.of.Long.Trips_log10 = Number.of.Long.Trips, Series.Complete.Pop.Pct_log10 = Series_Complete_Pop_Pct, County.POP_log10 = County.POP, County.Median.Income_log10 = County_Median_Income, Unemployment.Pct_log10 = unemployment_pct_2020, Median.Age_log10 = MEDIAN_AGE_TOT)

```


#### Variable Table

```{r Columns of dataframe being used for analysis,include=FALSE}
names(d_log10)
```


The Variable Table below relates the variable names in our model to their short form and description of the operationalized concept.

```{r echo=FALSE}
display_table <- data.frame(
                            "Variable Name" = c("Number.of.Long.Trips_log10", "Series.Complete.Pop.Pct_log10",
                                                "County.POP_log10", "County.Median.Income_log10",
                                                "isRepublican", "Unemployment.Pct_log10", "Median.Age_log10"),
                            "Variable Short Form" = c("County Level Long Trips Taken (Log10)",
                                                      "County Level Vaccination complete percentage (Log10)",
                                                      "County Population   (Log10)",
                                                      "County Median Income (Log10)",
                                                      "Binary Value 1 for Republican",
                                                      "County Unemployment Percentage (Log10)",
                                                      "County Median Age (Log10)"
                                                      ),
                            "Variable Description" = c("Number of 50+ mile trips taken by people from their home. Represents tourism trips.",
                                                       "Percentage of people who are fully vaccinated.",
                                                       "County Population Number.",
                                                       "Median County Population.",
                                                       "Indicates Party affiliation of County.",
                                                       "County's Unemployment Percentage.",
                                                       "County's Median Age."
                                                       )
                            )

display_table %>%
  kbl() %>%
  kable_styling()

```


#### Akaike Information Criterion

With our transformed variables, we run the Akaike Information Criterion (AIC) to see which models fit the given data the most. For the test, we begin with our limited model and we have our full possible model as we include every covariate.

**Limited Model:**


$$f_1(\text{Long_Distance_Trips }) =   \beta_0 +  \beta_1    f_2(\text{Fully_Vaccinated_Pct})$$




**Full Model:**

$$f_1(\text{Long_Distance_Trips }) =   \beta_0 +  \beta_1    f_2(\text{Fully_Vaccinated_Pct}) + \\ \beta_2 f_3(\text{County_Population}) + \beta_3 f_4(\text{Median_County_Income}) + \beta_4 \text{isRepublican} + \\
\beta_5    f_5(\text{Unemployment_Pct }) + \beta_6    f_7(\text{Median_Age})$$



Where the transformations are:

$$f_1(x) = \log_{10}(x) \\
f_2(x) = \log_{10}(x) \\
f_3(x) = \log_{10}(x) \\
f_4(x) = \log_{10}(x) \\
f_5(x) = \log_{10}(x) \\ 
f_6(x) = \log_{10}(x) \\ 
f_7(x) = \log_{10}(x)$$



**Running the AIC Test**:


```{r echo=FALSE}
step(
  lm(formula = Number.of.Long.Trips_log10 ~ Series.Complete.Pop.Pct_log10, data = d_log10), 
  list(upper = lm(formula = Number.of.Long.Trips_log10 ~ Series.Complete.Pop.Pct_log10 + County.POP_log10 + County.Median.Income_log10 + isRepublican + Unemployment.Pct_log10 + Median.Age_log10, data = d_log10)), 
  direction = "forward")
```

The AIC tests show that the model with the lowest AIC score, which fits the data the best, is the model that only excludes the unemployment percentage variable `Unemployment.Pct_log10`. This lowest AIC model will be our model 3, with the maximum inclusion of useful covariates. Our model 2 will be the model that includes the vaccination rate, county population, and the median age (`Series.Complete.Pop.Pct_log10`, `County.POP_log10`, `Median.Age_log10`). The AIC of this model 2 is -517.67, and choosing model 3 only decreases the AIC by approximately 2. Model 2 has a limited number of controls but should capture the data almost as well as our best model 3, and the 3 variables are not multicollinear based on the further analysis below.


### 2.2 Models


We present the following three models for our report.

**Limited Model:**

$$f_1(\text{Long_Distance_Trips }) =   \beta_0 +  \beta_1    f_2(\text{Fully_Vaccinated_Pct})$$



**Model 2:**

$$f_1(\text{Long_Distance_Trips }) =   \beta_0 +  \beta_1    f_2(\text{Fully_Vaccinated_Pct}) + \\ \beta_2 f_3(\text{County_Population}) + \beta_3    f_4(\text{Median_Age})$$

**Model 3:**

$$f_1(\text{Long_Distance_Trips }) =   \beta_0 +  \beta_1    f_2(\text{Fully_Vaccinated_Pct}) + \\ \beta_2 f_3(\text{County_Population}) + \beta_3    f_4(\text{Median_Age}) + \\
\beta_4 \text{isRepublican} + \beta_3 f_5(\text{Median_County_Income})$$


**Our transformations:**

$$f_1(\text{Long_Distance_Trips }) = \log_{10}(\text{Long_Distance_Trips }) \\
f_2(\text{Fully_Vaccinated_Pct}) = \log_{10}(\text{Fully_Vaccinated_Pct}) \\
f_3(\text{County_Population}) = \log_{10}(\text{County_Population}) \\
f_4(\text{Median_Age}) = \log_{10}(\text{Median_Age}) \\
f_5(\text{Median_County_Income}) = \log_{10}(\text{Median_County_Income})$$



```{r echo=FALSE, message=FALSE, warning=FALSE}

model_limited = lm(formula = Number.of.Long.Trips_log10 ~ Series.Complete.Pop.Pct_log10, data = d_log10)

model_2 = lm(formula = Number.of.Long.Trips_log10 ~ Series.Complete.Pop.Pct_log10 + 
    County.POP_log10 + Median.Age_log10, data = d_log10)

model_3 = lm(formula = Number.of.Long.Trips_log10 ~ Series.Complete.Pop.Pct_log10 + 
    County.POP_log10 + Median.Age_log10 + isRepublican + County.Median.Income_log10, 
    data = d_log10)

```

```{r message=FALSE, warning=FALSE, include=FALSE}
summary(model_limited)
summary(model_2)
summary(model_3)

```

```{r Extract only p-value of Model, message=FALSE, warning=FALSE, include=FALSE}
# extracting p value
mod_summary <- summary(model_2)
pf(mod_summary$fstatistic[1],              # Applying pf() function
   mod_summary$fstatistic[2],
   mod_summary$fstatistic[3],
   lower.tail = FALSE)
```

## 3. Regression Table

**Regression Table using Robust Standard Errors:**

```{r echo=FALSE, message=FALSE, warning=FALSE }
stargazer(
   model_limited, model_2, model_3,
   type = 'text', column.sep.width = "1pt",font.size = "small",no.space = TRUE,
   se = list(get_robust_se(model_limited), get_robust_se(model_2), get_robust_se(model_3)) # use robust standard errors
   )
```

The above table shows the comparison of our `Limited Model`, `Model 2` and `Model 3`. We note that both `Model 2` and `Model 3` include statistically significant coefficients, particularly for our treatment vaccination rate `Series.Complete.Pop.Pct_log10`.

### 3.1 Statistical Significance

Both Models 2 and 3 include statistically significant coefficients for `Series.Complete.Pop.Pct_log10` and `County.POP_log10`. The Adjusted $R^2$ of both models are 0.96. The standard errors are very near to each other with a value of 0.124 and 0.122 respectively.

The $\beta_1$ in our models, the coefficient for vaccination rate `Series.Complete.Pop.Pct_log10`, is a statistically significant negative value. We note that both the outcome variable and the treatment variable are both log10 transformed. Holding all other controls constant, we see that a 10% increase in vaccine rate (Treatment Variable) means a **reduction** of 5.6% (model 2) or 4.2% (model 3) in the number of Long Trips undertaken (Outcome Variable). This implies that increasing vaccination rates have a decreasing effect on the number of long trips taken currently, so places with higher vaccination rates yield fewer tourism trips by the residents.

The $\beta_2$ in our models, the coefficient for county population `County.POP_log10 `, is a statistically significant positive value. We note that both the outcome variable and the treatment variable are both log10 transformed. Holding all other controls constant, we see that a 10% increase in county population means an **increase** of 8.1% (model 2) or 8.6% (model 3) in the number of Long Trips taken (Outcome Variable). This implies that holding all other variables constant, including vaccination rate, increases in county population will lead to more tourism trips simply due to more residents.

In both models 2 and 3, other covariates did not have statistically significant coefficients. This implies their effect on the number of long trips taken is not statistically significant.

### 3.2 Practical Significance

Even though we notice a statistical significance in the coefficient for vaccination rate `Series.Complete.Pop.Pct_log10`, we do not anticipate a practical significance. We have seen that a 10% increase in vaccine rate (reasonable increase in the short term upcoming months) means a 4.2% (model 3) or 5.6% (model 2) decrease in the number of tourism trips undertaken. For example, let us consider a scenario at a tourism destination like Disneyland. If Disneyland was expecting 10,000 visitors in a week and gets only 9,440 visitors in the week. This situation neither warrants a significant action on promotion strategy nor warrant action in reducing operational costs.

While increasing vaccination rates imply a decrease in tourism trips taken, the size of that decrease is not enough for tourism destinations to drastically change their business policy.


## 4. Limitations of the Model and CLM Assumptions

Our model shows a decrease in trips undertaken with an increase in the vaccination rate. However, if vaccination rates were in the realm of 70% to 90% we would not expect this trend to hold since it means that the United States, or the West Coast States at least, are in a different state of the pandemic than now. In short, our model does not extend to very large increases in vaccination rates that might put most counties to be at an almost fully vaccinated scenario. Instead, our model can provide causal insight into how small, reasonable increases in vaccination rates would impact tourism trips taken now. Another limitation is that our model considers all trips greater than 50+ miles as tourism trips, but there may be some business trips in these numbers for which we do not have the data. We wanted to acknowledge this lack of data in our model. These business trips may only be a few until all offices are at a capacity of pre-pandemic levels as most people are still working from home. We may or may not see an impact due to this limitation, and our model can be rerun if we have such data available.

```{r include=FALSE}
# add residuals into our data
d_log10 <- d_log10 %>%  
  mutate(model_limited_residuals = resid(model_limited)) # model predict - actual

d_log10 <- d_log10 %>% 
  mutate(model_limited_prediction = predict(model_limited))

d_log10 <- d_log10 %>%  
  mutate(model_2_residuals = resid(model_2)) # model predict - actual

d_log10 <- d_log10 %>% 
  mutate(model_2_prediction = predict(model_2))

d_log10 <- d_log10 %>%  
  mutate(model_3_residuals = resid(model_3)) # model predict - actual

d_log10 <- d_log10 %>% 
  mutate(model_3_prediction = predict(model_3))
```

Below we will discuss and check whether our two models (not including the limited model) satisfy the Classical Liner Model assumptions.

### 4.1 Independent and Identically Distributed (IID)

The observations in our models are limited to all the counties in the continental west coast states of California, Oregon, and Washington. Most of the west coast region counties share similar social, cultural, political, economic, and geographical features. This similarity of features means that the counties in this region are mostly identical except for some deviations like population, median income level, and counties’ political leaning (Democrat or Republican party). Population, median income level, and political leaning can influence the number of long-distance trips taken in a county, in addition to the percentage of vaccinated people. To control the differences due to these additional features, we included population, median income level, and 2020 county-level presidential results (party with the highest percentage of votes) as covariates in our model and can assume that the observations are identically distributed. 

However, we also acknowledge that some neighboring counties or geographic clusters of counties in this region can influence or cause some dependency between the observations. High income or high population counties can often be neighbors and share other feature values such as political affiliation. A prime example of this would be high-income counties in Silicon Valley having similar Democrat-leaning politics and similar access to vaccines. Another example would be small population counties in California, situated away from metropolitan centers, being Republican-leaning. Hence, the assumption of independence is not met in the data. Based on the deficiencies in the IID assumption, we need to be wary of interpreting the model results and understand that the actual results may vary more than what the model suggests, i.e., the standard errors in the model are likely lower than actual uncertainty.


### 4.2 Linear Conditional Expectation

We validate the linear conditional expectation assumption for our models 2 and 3 by a visual inspection of the plot between the model residuals on the y-axis and the model predicted values on the x-axis. The plots show that the residuals line for both models 2 and 3 are very close to 0 and only reaching 0.1 at the tails. 


```{r eval=FALSE, include=FALSE}
plot(model_limited,which=1)
```


```{r eval=FALSE, message=FALSE, warning=FALSE, include=FALSE}
# model 1

plot_model_1a <- d_log10 %>%  
  ggplot(aes(x = Series.Complete.Pop.Pct_log10, y = Number.of.Long.Trips_log10)) + 
  geom_point() + stat_smooth()

plot_model_1b <- d_log10 %>%  
  ggplot(aes(x = Series.Complete.Pop.Pct_log10, y = model_limited_residuals)) + 
  geom_point() + stat_smooth()

(plot_model_1a / plot_model_1b)

```


```{r Model Residuals and Predictions, echo=FALSE, message=FALSE, warning=FALSE, fig.cap="**Model Residuals and Predictions**"}
# model 2 and 3

plot_model_21 <- d_log10 %>%
ggplot(aes(x = model_2_prediction, y = model_2_residuals)) +
geom_point() + stat_smooth() +
labs( x = "Model 2 Predictions", y = "Model 2 Residuals")


plot_model_31 <- d_log10 %>%
ggplot(aes(x = model_3_prediction, y = model_3_residuals)) +
geom_point() + stat_smooth() +
labs( x = "Model 3 Predictions", y = "Model 3 Residuals")


(plot_model_21 / plot_model_31)

```

```{r eval=FALSE, include=FALSE}
plot(model_2,which=1)
```


```{r eval=FALSE, message=FALSE, include=FALSE}
# model 2

plot_model_2a <- d_log10 %>%  
  ggplot(aes(x = Series.Complete.Pop.Pct_log10, y = model_2_residuals)) + 
  geom_point() + stat_smooth()

plot_model_2b <- d_log10 %>% 
  ggplot(aes(x = County.POP_log10, y = model_2_residuals)) + 
  geom_point() + stat_smooth()

plot_model_2c <- d_log10 %>% 
  ggplot(aes(x = Median.Age_log10, y = model_2_residuals)) + 
  geom_point() + stat_smooth()

plot_model_2d <- d_log10 %>%  
  ggplot(aes(x = model_2_prediction, y = model_2_residuals)) + 
  geom_point() + stat_smooth()

(plot_model_2a | plot_model_2b) / (plot_model_2c | plot_model_2d)

```



```{r eval=FALSE, include=FALSE}
plot(model_3,which=1)
```

While the models look good in meeting the linear conditional expectation assumption, we check if there are any issues with some of the key covariates included in our model 3 by plotting the model residuals on the y-axis with the covariates on the x-axis. The covariates selected for these plots with the model 3 residuals are the log10 values of the following variables: percentage of population vaccinated in each county, the total population of the county, the median age of county residents, and the median income of the county residents. All the plots between the model residuals and the covariates look good and the residual lines are closer to 0 in each of the plots and do not cross 0.2. There seem to be no issues with the covariates included in the model. The linear conditional expectation is met for both models 2 and 3.

```{r Model Residuals and Variables, echo=FALSE, message=FALSE, fig.cap="**Model Residuals and Variables**"}
vac_resid <- d_log10 %>%
ggplot(aes(x = Series.Complete.Pop.Pct_log10, y = model_3_residuals)) +
geom_point() + stat_smooth() +
labs (x = "Log 10 of Percentage Vaccinated", y = "Model 3 Residuals")


pop_resid <- d_log10 %>%
ggplot(aes(x = County.POP_log10, y = model_3_residuals)) +
geom_point() + stat_smooth() +
labs (x = "Log 10 of County Population", y = "Model 3 Residuals")


age_resid <- d_log10 %>%
ggplot(aes(x = Median.Age_log10, y = model_3_residuals)) +
geom_point() + stat_smooth() +
labs (x = "Log 10 of Median Age", y = "Model 3 Residuals")


inc_resid <- d_log10 %>%
ggplot(aes(x = County.Median.Income_log10, y = model_3_residuals)) +
geom_point() + stat_smooth() +
labs (x = "Log 10 of Median Income", y = "Model 3 Residuals")


(vac_resid / pop_resid) 
(age_resid / inc_resid )

```



```{r eval=FALSE, message=FALSE, warning=FALSE, include=FALSE}
# model 3

plot_model_3a <- d_log10 %>%  
  ggplot(aes(x = Series.Complete.Pop.Pct_log10, y = model_3_residuals)) + 
  geom_point() + stat_smooth()

plot_model_3b <- d_log10 %>% 
  ggplot(aes(x = County.POP_log10, y = model_3_residuals)) + 
  geom_point() + stat_smooth()

plot_model_3c <- d_log10 %>% 
  ggplot(aes(x = Median.Age_log10, y = model_3_residuals)) + 
  geom_point() + stat_smooth()

plot_model_3d <- d_log10 %>% 
  ggplot(aes(x = as.numeric(isRepublican), y = model_3_residuals)) + 
  geom_point() + stat_smooth()

plot_model_3e <- d_log10 %>% 
  ggplot(aes(x = County.Median.Income_log10, y = model_3_residuals)) + 
  geom_point() + stat_smooth()

plot_model_3f <- d_log10 %>%  
  ggplot(aes(x = model_3_prediction, y = model_3_residuals)) + 
  geom_point() + stat_smooth()

(plot_model_3a | plot_model_3b) / (plot_model_3c | plot_model_3d) / (plot_model_3e | plot_model_3f)

```


### 4.3 No Perfect Multicollinearity

If one of the covariates can be written as a linear combination of another covariate, it is not possible to solve for the OLS estimator. In such cases, we say that there is perfect multicollinearity. We can check for multicollinearity in two different ways **1)** By using the Variance Inflation Factor (VIF) of the regression coefficients in the model and **2)** Calculating the paired correlation values of the covariates in the model. 

We checked the VIF of both models 2 and 3. Below are the results:
 

```{r VIF, echo=FALSE}
message('Model 2 VIF\n')
vif(model_2)

message('\nModel 3 VIF\n')
vif(model_3)

```

Usually, when VIF of the regression coefficients is less than 4 we assume there is no perfect collinearity. We can see that the VIF of the regression coefficients is less than 4 in both model 2 and 3. The assumption of no perfect collinearity is met for both the models.

### 4.4 Homoskedastic Errors

In the CLM model, we assume that the errors are homoskedastic. This means that the errors terms do not vary much based on the predicted values in the model. We can evaluate homoskedastic assumption by viewing the plot between the standardized residuals and the fitted values or by performing a Breusch–Pagan test on the model. If the errors are homoskedastic, the line in the standardized residuals vs. fitted values plot will be horizontal. We can see that for both our models 2 and 3, the line is not horizontal and there is a slope to it. There seems to be a larger variation associated with the error terms based on different predicted values. This observation can be confirmed by the results of the Breusch–Pagan test on both the models which produce a p-value less than 0.05 that is statistically significant. Based on the p-values, the null hypothesis that the error variances are equal throughout (homoskedasticity) is rejected. Models 2 and 3 do not meet the assumption of homoskedastic errors. We should understand that the estimated errors in these models may not reflect the true uncertainty. Hence, any conclusion arrived at based on the errors and the hypothesis tests on these models may not be reliable.

```{r Standardized Residuals and Fitted Values, echo=FALSE, fig.cap="**Standardized Residuals and Fitted Values**", fig.width=5, fig.height=3}
# Ocular Method Checking for Homoskedastic Errors

plot(model_2, which=3, main = "Model 2") 
plot(model_3, which=3, main = "Model 3")

```


```{r BP Test, echo=FALSE}

# Model 2: Breusch-Pagan test against heteroskedasticity.
bptest(model_2)

# Model 3: Breusch-Pagan test against heteroskedasticity.
bptest(model_3)

```

The Breusch-Pagan test rejects the null hypothesis for the homoskedastic conditional variance for models 2 & 3. We must use robust standard errors in our reporting because we do not have homoskedasticity and our models do not meet this CLM assumption. Our regression table above is reported using robust standard errors.

### 5.5 Normally Distributed Errors

Normality of errors is another key assumption of the classical linear model. We can verify the normal distribution assumption by viewing the histogram of the model residuals or by viewing a Q-Q norm plot between the theoretical values and the standardized residuals. The histogram of the residuals of both models looks almost normal. The Q-Q norm plot confirms that the actual residuals and the theoretical residuals fall along the same line for a major portion except for the ends in both models. The plots are not too bad as the central portion is overlapping with the line. Usually, Q-Q norm plots tend to curve at the tails due to a lack of data. We can confirm that our models 2 and 3 meet the assumption of normally distributed errors through histograms and the Shapiro Wilk's test.

```{r Residuals Histogram, echo=FALSE, fig.cap="**Residuals Histogram**", fig.width=5, fig.height=3}
# Ocular Method: Histograms of Residuals:

hist(model_2$residuals, main = "Model 2", xlab = "Model 2 Residuals")
hist(model_3$residuals, main = "Model 3", xlab = "Model 3 Residuals")



```



```{r Q-Q Plots, echo=FALSE, fig.cap="**Q-Q Norm plot**", fig.width=5, fig.height=3}
# Ocular Method: QQNorm plots:
plot(model_2,which=2, xlab = "Model 2 Theoritical Quantities") 
plot(model_3,which=2, xlab = "Model 3 Theoritical Quantities") 
```



```{r Shapiro Wilks Test, echo=FALSE}
# Shapiro-Wilk’s test for normality:

# For Model 2

shapiro.test(d_log10$model_2_residuals)

# For Model 3
shapiro.test(d_log10$model_3_residuals)
```

The Shapiro-Wilk normality test on the residuals of model 2 and model 3 both result in a p-value exceeding 0.05. This means that we fail to reject the null hypothesis of normally distributed residuals. Our assumption that Model 2 and Model 3 have normally distributed residuals are met.


## 5. Discussion of Omitted Variables

Our model tries to find the causal relationship between the number of long trips undertaken by the residents of the counties in the continental west coast states and the percentage of fully vaccinated people in these counties. While we try to improve our model’s fit by including a number of applicable covariates that affect the predictor variable, we also acknowledge that there may be some omitted variables (OV) that we should be aware of. In this section, we talk about the omitted variables and their potential impact on the models.

1.	OV - Policy of lifting mask mandate: We tried to gather policy data, but were unable to find the details at the county level. Hence, we discuss the potential impact of this omitted variable on our model, if such data was available. Based on the model coefficients calculated, we see that the number of long trips has a negative relationship with the vaccination rate. We anticipate that higher vaccination percentages would more likely lead to lifting a mask mandate which is a positive relationship. Lifting a mask mandate would boost the confidence of the county residents that the pandemic is under control, and that might have a positive relationship with the number of long trips. The direction of OV bias is positive, but the measured coefficient is negative. With these relationships, the estimated coefficient of vaccination percentage is greater than the true coefficient and the direction of bias is towards 0. Our effect found for vaccination rate on long trips taken is more likely to be real since this OV bias is pushing our coefficient towards 0.

2.	OV – COVID Fatigue: COVID fatigue measures how tired people are of being in a lockdown or constantly hearing news coverage about Covid-19. There is no data available on COVID fatigue. Hence, we discuss the potential impact of this omitted variable on our model, if such data was available. We discussed above that the number of long trips has a negative relationship with the vaccination rate. We anticipate that more fatigued people are more likely to travel since they would like to leave the places they have been stuck in for months, which is a positive relationship. If vaccinate rates are increasing, it is likely due to active pushes by the local media, government, or residents. Hearing daily about the necessity of getting the vaccine and the consequences of not being vaccinated can increase existing COVID fatigue, leading to a positive relationship with the vaccination rates. The direction of OV bias is positive, but the measured coefficient is negative. With these relationships, the estimated coefficient of vaccination percentage is greater than the true coefficient and the direction of bias is towards 0. Our effect found for vaccination rate on long trips taken is more likely to be real since this OV bias is pushing our coefficient towards 0.

3.	OV – Vaccine Hesitancy: This variable measures the percentage of people at the county level who describe themselves as “unsure”, “probably not”, or “definitely not” going to get a COVID-19 vaccine. There is no vaccine hesitancy data available at the county level. Hence, we discuss the potential impact of this omitted variable on our model, if such data was available. We discussed above that the number of long trips has a negative relationship with the vaccination rate. Having a higher percentage of vaccine hesitancy or skepticism means that there may be a positive relationship with the number of trips since these people may not believe in science and have little hesitation about traveling unvaccinated. Getting more people vaccinated could reduce vaccine hesitancy to some extent because it becomes normalized and trusted, so this relationship is negative. The direction of OV bias is negative, and the measured coefficient is negative. With these relationships, the estimated coefficient of vaccination percentage is less than the true coefficient, and the direction of the bias is away from 0. Our effect found for vaccination rate on long trips taken is less likely to be real since this OV bias is pushing our coefficient away from 0.

## 6. Conclusion

Our analysis shows that tourism demand, measured through the number of long trips undertaken from home, is slightly decreasing with rising vaccination rates, but not at a practically significant amount. This shows that even though people are getting vaccinated they are wary about the possibility of uncertainty looming around with different variants and may not be feeling safe to take vacations.

Based on the research conducted above, we recommend the following to the **Tourism Board of Continental West Coast States**:

* It is recommended to exercise caution prior to promoting or increasing any of the expenditure on tourism because our research shows that people are not yet feeling comfortable taking vacations even after being fully vaccinated. This could be due to news about Covid-19 variants or knowledge that other places might still have low vaccination rates. In places where the vaccination rate is higher people may be taking fewer vacation trips, likely due to existing science-based precautions during the pandemic and acknowledgment that Covid-19 is not quite over in the U.S.

* We recommend a reevaluation of promoting tourism in the future when the vaccination rates are much higher across counties. The Covid-19 climate in the West Coast might be different in the future once all vaccination rates are above a threshold of 80% compared to the current 29.9% average. Residents might be more comfortable traveling and undertaking long trips if being vaccinated is the norm everywhere.
